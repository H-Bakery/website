(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4521],{10780:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eA});var n=s(95155),i=s(12115),r=s(63159),a=s(16150),l=s(9670),o=s(55857),d=s(90746),c=s(55965),m=s(15843);let u=async()=>[{id:"wf-001",name:"croissant_production",version:"1.2",product:"Butter Croissants",startTime:new Date(new Date().getTime()-36e5),estimatedEndTime:new Date(new Date().getTime()+72e5),status:"in-progress",batchSize:48,assignedTo:"Franz M\xfcller",steps:[{id:"step-001",name:"teig_vorbereiten",type:"manual",status:"completed",progress:100,activities:[{name:"mixen",completed:!0},{name:"kneten",completed:!0},{name:"buttereinschlagen",completed:!0}],notes:"K\xfchlen Sie die Butter auf 8\xb0C herunter",startTime:new Date(new Date().getTime()-36e5),endTime:new Date(new Date().getTime()-3e6)},{id:"step-002",name:"erste_gehzeit",type:"sleep",duration:"2h",status:"completed",progress:100,location:"K\xfchlraum",conditions:{"temp > 22\xb0C":"1.5h","temp < 18\xb0C":"2.5h"},startTime:new Date(new Date().getTime()-3e6),endTime:new Date(new Date().getTime()-18e5)},{id:"step-003",name:"laminieren",type:"manual",status:"in-progress",progress:65,activities:[{name:"ausrollen",completed:!0},{name:"falten",completed:!0},{name:"k\xfchlen",completed:!1}],notes:"Nach jedem Durchgang 20 Minuten k\xfchlen",startTime:new Date(new Date().getTime()-18e5)},{id:"step-004",name:"zweite_gehzeit",type:"sleep",duration:"1h",status:"pending",progress:0,location:"K\xfchlraum"},{id:"step-005",name:"formen",type:"manual",status:"pending",progress:0,activities:[{name:"ausrollen",completed:!1},{name:"schneiden",completed:!1},{name:"rollen",completed:!1}]},{id:"step-006",name:"final_proofing",type:"sleep",duration:"1.5h",status:"pending",progress:0,conditions:{"temp > 25\xb0C":"1h"}},{id:"step-007",name:"backen",type:"manual",status:"pending",progress:0,notes:"Vorher mit Ei bestreichen",params:{temp:"190\xb0C"}}]},{id:"wf-002",name:"sourdough_bread",version:"1.0",product:"Sauerteigbrot",startTime:new Date(new Date().getTime()-288e5),estimatedEndTime:new Date(new Date().getTime()+216e5),status:"in-progress",batchSize:12,assignedTo:"Maria Schmidt",steps:[{id:"step-101",name:"starter_f\xfcttern",type:"manual",status:"completed",progress:100,activities:[{name:"mischen",completed:!0}],notes:"Sauerteig im Verh\xe4ltnis 1:1:1 (Starter:Mehl:Wasser) f\xfcttern",startTime:new Date(new Date().getTime()-288e5),endTime:new Date(new Date().getTime()-282e5)},{id:"step-102",name:"starter_reifen",type:"sleep",duration:"8h",status:"completed",progress:100,conditions:{"temp < 20\xb0C":"10h"},notes:"Starter sollte sich verdoppeln",startTime:new Date(new Date().getTime()-282e5),endTime:new Date(new Date().getTime()-108e5)},{id:"step-103",name:"teig_mischen",type:"manual",status:"completed",progress:100,activities:[{name:"mehl_wiegen",completed:!0},{name:"wasser_zugeben",completed:!0},{name:"salz_zugeben",completed:!0},{name:"mischen",completed:!0}],startTime:new Date(new Date().getTime()-108e5),endTime:new Date(new Date().getTime()-105e5)},{id:"step-104",name:"autolyse",type:"sleep",duration:"1h",status:"completed",progress:100,startTime:new Date(new Date().getTime()-105e5),endTime:new Date(new Date().getTime()-69e5)},{id:"step-105",name:"kneten_und_falten",type:"manual",status:"completed",progress:100,activities:[{name:"kneten",completed:!0},{name:"stretch_and_fold",completed:!0}],startTime:new Date(new Date().getTime()-69e5),endTime:new Date(new Date().getTime()-66e5)},{id:"step-106",name:"erste_gehzeit",type:"sleep",duration:"4h",status:"in-progress",progress:40,conditions:{"temp > 26\xb0C":"3h"},startTime:new Date(new Date().getTime()-66e5)}]},{id:"wf-003",name:"croissant_production",version:"1.2",product:"Schokoladen Croissants",startTime:new Date(new Date().getTime()+36e5),estimatedEndTime:new Date(new Date().getTime()+144e5),status:"planned",batchSize:36,assignedTo:"Lisa Wagner",steps:[{id:"step-001",name:"teig_vorbereiten",type:"manual",status:"pending",progress:0,activities:[{name:"mixen",completed:!1},{name:"kneten",completed:!1},{name:"buttereinschlagen",completed:!1}],notes:"K\xfchlen Sie die Butter auf 8\xb0C herunter"},{id:"step-002",name:"erste_gehzeit",type:"sleep",duration:"2h",status:"pending",progress:0,location:"K\xfchlraum",conditions:{"temp > 22\xb0C":"1.5h","temp < 18\xb0C":"2.5h"}}]}],x=async(e,t,s)=>{let n=(await u()).find(t=>t.id===e);if(!n)throw Error("Workflow not found");let i={...n,steps:n.steps.map(e=>e.id===t?{...e,...s}:e)},r=i.steps.every(e=>"completed"===e.status),a=i.steps.some(e=>"in-progress"===e.status);return r?i.status="completed":a&&(i.status="in-progress"),i},p=async e=>{let t=(await u()).find(t=>t.id===e);if(!t)throw Error("Workflow not found");return{...t,status:"in-progress",startTime:new Date,steps:t.steps.map((e,t)=>0===t?{...e,status:"in-progress",progress:0,startTime:new Date}:e)}},h=async e=>{let t=(await u()).find(t=>t.id===e);if(!t)throw Error("Workflow not found");return{...t,status:"paused"}};var g=s(73746),j=s(84256),A=s(83339),f=s(44557),y=s(80460),b=s(91580),v=s(7433),w=s(80158),T=s(49471),D=s(75125),z=s(61331);let S=e=>{let t=e.steps.length,s=e.steps.filter(e=>"completed"===e.status).length,n=e.steps.find(e=>"in-progress"===e.status),i=s/t*100;return n&&(i+=n.progress/100*(1/t)*100),Math.round(i)},k=e=>{let t=new Date,s=e.estimatedEndTime.getTime()-t.getTime();if(s<=0)return"F\xe4llig";let n=Math.floor(s/36e5),i=Math.floor(s%36e5/6e4);return n>0?"".concat(n,"h ").concat(i,"m"):"".concat(i,"m")},C=e=>{switch(e){case"completed":return"success";case"in-progress":return"primary";case"paused":return"warning";case"planned":return"info";default:return"default"}},_=e=>({parsed:!0,yaml:e}),W=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return{id:"wf-".concat(Date.now()),name:e.name||"new_workflow",version:e.version||"1.0",product:"New Product",startTime:t,estimatedEndTime:new Date(t.getTime()+36e5),status:"planned",batchSize:0,assignedTo:"",steps:[]}},P=e=>{let{workflows:t,selectedWorkflow:s,activeTab:i,onTabChange:r,onSelectWorkflow:o}=e,d=(0,g.A)(),c=t.filter(e=>"in-progress"===e.status).length,m=t.filter(e=>"planned"===e.status).length,u=t.reduce((e,t)=>(new Date(t.startTime).toDateString()===new Date().toDateString()&&(e[t.product]?e[t.product]+=t.batchSize:e[t.product]=t.batchSize),e),{});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.A,{sx:{mb:3},children:(0,n.jsxs)(A.A,{children:[(0,n.jsx)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:(0,n.jsx)(l.A,{variant:"h6",children:"Aktive Prozesse"})}),(0,n.jsxs)(f.A,{value:i,onChange:r,variant:"fullWidth",textColor:"primary",indicatorColor:"primary",sx:{mb:2},children:[(0,n.jsx)(y.A,{icon:(0,n.jsx)(T.A,{}),label:"Aktiv"}),(0,n.jsx)(y.A,{icon:(0,n.jsx)(D.A,{}),label:"Geplant"})]}),t.filter(e=>0===i?"in-progress"===e.status||"paused"===e.status:"planned"===e.status).map(e=>(0,n.jsx)(j.A,{variant:"outlined",sx:{mb:1,cursor:"pointer",border:(null==s?void 0:s.id)===e.id?"2px solid ".concat(d.palette.primary.main):void 0},onClick:()=>o(e),children:(0,n.jsxs)(A.A,{sx:{p:2,"&:last-child":{pb:2}},children:[(0,n.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,n.jsx)(l.A,{variant:"subtitle2",noWrap:!0,children:e.product}),(0,n.jsx)(b.A,{label:e.status,size:"small",color:C(e.status),sx:{textTransform:"capitalize"}})]}),(0,n.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,n.jsxs)(l.A,{variant:"body2",color:"text.secondary",children:["Menge: ",e.batchSize]}),(0,n.jsxs)(l.A,{variant:"body2",color:"text.secondary",children:[(0,n.jsx)(z.A,{sx:{fontSize:14,verticalAlign:"middle",mr:.5}}),k(e)]})]}),(0,n.jsx)(v.A,{variant:"determinate",value:S(e),sx:{height:6,borderRadius:3}})]})},e.id))]})}),(0,n.jsx)(j.A,{children:(0,n.jsxs)(A.A,{children:[(0,n.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:"Produktions\xfcbersicht"}),(0,n.jsxs)(a.A,{sx:{mb:2},children:[(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Aktive Prozesse"}),(0,n.jsx)(l.A,{variant:"h5",children:c})]}),(0,n.jsxs)(a.A,{sx:{mb:2},children:[(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Geplante Prozesse"}),(0,n.jsx)(l.A,{variant:"h5",children:m})]}),(0,n.jsx)(w.A,{sx:{my:2}}),(0,n.jsxs)(a.A,{children:[(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Fertigung heute"}),Object.entries(u).map(e=>{let[t,s]=e;return(0,n.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mt:1},children:[(0,n.jsx)(l.A,{children:t}),(0,n.jsxs)(l.A,{children:[s," Stk."]})]},t)}),0===Object.keys(u).length&&(0,n.jsx)(l.A,{variant:"body2",sx:{mt:1,fontStyle:"italic",color:"text.secondary"},children:"Keine Produktion f\xfcr heute geplant"})]}),(0,n.jsx)(w.A,{sx:{my:2}}),(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Temperaturen"}),(0,n.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mt:1},children:[(0,n.jsx)(l.A,{children:"K\xfchlraum"}),(0,n.jsx)(l.A,{children:"4\xb0C"})]}),(0,n.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mt:1},children:[(0,n.jsx)(l.A,{children:"Backstube"}),(0,n.jsx)(l.A,{children:"22\xb0C"})]})]})})]})};var I=s(29633),B=s(53670),E=s(62861),M=s(62966),F=s(12422),V=s(73831),N=s(78679),L=s(72761),K=s(57706),O=s(9337),R=s(69555),G=s(13319),H=s(15876),U=s(18203),Y=s(25949),Z=s(72137),q=s(3967),J=s(33470),Q=s(57236),X=s(50514),$=s(44146),ee=s(86223),et=s(3605),es=s(65467),en=s(43927),ei=s(53333),er=s(26348),ea=s(1384);let el=e=>{let{steps:t,onComplete:s,onEditNotes:i,disabled:r}=e;return(0,n.jsx)(H.A,{component:U.A,variant:"outlined",children:(0,n.jsxs)(Y.A,{children:[(0,n.jsx)(Z.A,{children:(0,n.jsxs)(q.A,{children:[(0,n.jsx)(J.A,{sx:{fontWeight:"bold"},children:"Schritt"}),(0,n.jsx)(J.A,{sx:{fontWeight:"bold"},children:"Typ"}),(0,n.jsx)(J.A,{sx:{fontWeight:"bold"},children:"Dauer"}),(0,n.jsx)(J.A,{sx:{fontWeight:"bold"},children:"Status"}),(0,n.jsx)(J.A,{sx:{fontWeight:"bold"},children:"Details"}),(0,n.jsx)(J.A,{sx:{fontWeight:"bold"},children:"Aktionen"})]})}),(0,n.jsx)(Q.A,{children:t.map(e=>(0,n.jsxs)(q.A,{sx:{bgcolor:"completed"===e.status?"success.50":"in-progress"===e.status?"primary.50":"inherit","&:hover":{backgroundColor:"completed"===e.status?"success.100":"in-progress"===e.status?"primary.100":"action.hover"}},children:[(0,n.jsxs)(J.A,{children:[(0,n.jsx)(l.A,{variant:"subtitle2",children:e.name.replace(/_/g," ")}),e.activities&&e.activities.length>0&&(0,n.jsx)(a.A,{sx:{mt:1,display:"flex",flexWrap:"wrap",gap:.5},children:e.activities.map((e,t)=>(0,n.jsx)(b.A,{label:e.name.replace(/_/g," "),size:"small",variant:"outlined",color:e.completed?"success":"default",sx:{height:20}},t))})]}),(0,n.jsx)(J.A,{children:(0,n.jsx)(b.A,{label:"sleep"===e.type?"Ruhezeit":"Manuell",size:"small",color:"sleep"===e.type?"info":"warning",sx:{textTransform:"capitalize"}})}),(0,n.jsxs)(J.A,{children:[e.duration||"-",e.conditions&&Object.keys(e.conditions).length>0&&(0,n.jsx)(X.A,{title:(0,n.jsx)("div",{children:Object.entries(e.conditions).map(e=>{let[t,s]=e;return(0,n.jsxs)("div",{children:["Bei ",t,": ",s]},t)})}),children:(0,n.jsx)($.A,{size:"small",children:(0,n.jsx)(et.A,{fontSize:"small"})})})]}),(0,n.jsx)(J.A,{children:(0,n.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column"},children:[(0,n.jsx)(a.A,{sx:{display:"flex",alignItems:"center"},children:(0,n.jsx)(b.A,{label:"completed"===e.status?"Abgeschlossen":"in-progress"===e.status?"In Bearbeitung":"pending"===e.status?"Ausstehend":"paused"===e.status?"Pausiert":"Fehler",size:"small",color:"completed"===e.status?"success":"in-progress"===e.status?"primary":"paused"===e.status?"warning":"error"===e.status?"error":"default",sx:{textTransform:"capitalize"}})}),("in-progress"===e.status||"completed"===e.status)&&(0,n.jsx)(v.A,{variant:"determinate",value:e.progress,sx:{mt:1,height:6,borderRadius:3}})]})}),(0,n.jsx)(J.A,{children:(0,n.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column"},children:[e.location&&(0,n.jsxs)(l.A,{variant:"body2",sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(es.A,{sx:{fontSize:16,mr:.5}}),e.location]}),e.startTime&&(0,n.jsxs)(l.A,{variant:"body2",sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(en.A,{sx:{fontSize:16,mr:.5}}),"Start: ",(0,G.GP)(new Date(e.startTime),"HH:mm")]}),e.notes&&(0,n.jsx)(X.A,{title:e.notes,children:(0,n.jsx)(ee.A,{color:"secondary",variant:"dot",children:(0,n.jsx)(ei.A,{fontSize:"small"})})})]})}),(0,n.jsxs)(J.A,{children:["in-progress"===e.status&&(0,n.jsx)($.A,{color:"success",onClick:()=>s(e.id),disabled:r,children:(0,n.jsx)(er.A,{})}),(0,n.jsx)($.A,{color:"primary",onClick:()=>i(e),children:(0,n.jsx)(ea.A,{})})]})]},e.id))})]})})};var eo=s(2395);let ed=e=>{let{workflow:t}=e,s=(0,g.A)(),i=e=>e?(0,G.GP)(new Date(e),"HH:mm 'Uhr'"):"",r=e=>{let{step:t,index:r,isLast:o}=e,d=s.palette.grey[400],c=s.palette.grey[300];return"completed"===t.status?(d=s.palette.success.main,c=s.palette.success.main):"in-progress"===t.status?(d=s.palette.primary.main,c=s.palette.primary.main):"error"===t.status?(d=s.palette.error.main,c=s.palette.error.main):"paused"===t.status&&(d=s.palette.warning.main,c=s.palette.warning.main),(0,n.jsx)(a.A,{sx:{mb:3},children:(0,n.jsxs)(a.A,{sx:{display:"flex"},children:[(0,n.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",width:50,position:"relative"},children:[(0,n.jsx)(a.A,{sx:{width:20,height:20,borderRadius:"50%",bgcolor:d,display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:14},children:r+1}),!o&&(0,n.jsx)(a.A,{sx:{height:"100%",width:2,bgcolor:c,my:.5}})]}),(0,n.jsx)(a.A,{sx:{flex:1,ml:2},children:(0,n.jsxs)(U.A,{elevation:"in-progress"===t.status?3:1,sx:{p:2.5,mb:1,bgcolor:"completed"===t.status?"success.50":"in-progress"===t.status?"primary.50":"background.paper",borderLeft:"4px solid ".concat(c)},children:[(0,n.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,n.jsx)(l.A,{variant:"h6",sx:{textTransform:"capitalize"},children:t.name.replace(/_/g," ")}),(0,n.jsx)(b.A,{label:"completed"===t.status?"Abgeschlossen":"in-progress"===t.status?"In Bearbeitung":"pending"===t.status?"Ausstehend":"paused"===t.status?"Pausiert":"Fehler",size:"small",color:"completed"===t.status?"success":"in-progress"===t.status?"primary":"paused"===t.status?"warning":"error"===t.status?"error":"default"})]}),"sleep"===t.type&&(0,n.jsx)(b.A,{label:"Ruhezeit",size:"small",color:"info",sx:{mb:1}}),(0,n.jsxs)(a.A,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center",mt:1.5},children:[(t.startTime||t.duration)&&(0,n.jsxs)(a.A,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(en.A,{sx:{fontSize:16,mr:.5,color:"text.secondary"}}),(0,n.jsxs)(l.A,{variant:"body2",color:"text.secondary",children:[t.startTime&&i(t.startTime),t.startTime&&t.endTime&&" - ",t.endTime&&i(t.endTime),!t.startTime&&t.duration&&"Dauer: ".concat(t.duration)]})]}),t.location&&(0,n.jsxs)(a.A,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(es.A,{sx:{fontSize:16,mr:.5,color:"text.secondary"}}),(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",children:t.location})]}),t.conditions&&Object.keys(t.conditions).length>0&&(0,n.jsx)(X.A,{title:(0,n.jsxs)(a.A,{children:[(0,n.jsx)(l.A,{variant:"caption",sx:{fontWeight:"bold"},children:"Bedingungen:"}),Object.entries(t.conditions).map(e=>{let[t,s]=e;return(0,n.jsxs)(l.A,{variant:"caption",display:"block",children:["• Bei ",t,": ",s]},t)})]}),children:(0,n.jsx)(b.A,{icon:(0,n.jsx)(et.A,{fontSize:"small"}),label:"Bedingungen",size:"small",variant:"outlined"})})]}),t.activities&&t.activities.length>0&&(0,n.jsxs)(a.A,{sx:{mt:2},children:[(0,n.jsx)(w.A,{sx:{my:1}}),(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Aktivit\xe4ten:"}),(0,n.jsx)(a.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:t.activities.map((e,t)=>(0,n.jsx)(b.A,{icon:e.completed?(0,n.jsx)(eo.A,{fontSize:"small"}):void 0,label:e.name.replace(/_/g," "),size:"small",color:e.completed?"success":"default",variant:e.completed?"filled":"outlined"},t))})]}),t.notes&&(0,n.jsx)(a.A,{sx:{mt:2,p:1,borderRadius:1,bgcolor:"background.paper",border:"1px dashed",borderColor:"divider"},children:(0,n.jsxs)(l.A,{variant:"body2",sx:{display:"flex",alignItems:"flex-start"},children:[(0,n.jsx)(ei.A,{sx:{fontSize:16,mr:.5,mt:.25},color:"action"}),t.notes]})})]})})]})})};return(0,n.jsx)(a.A,{sx:{mt:2,px:2},children:t.steps.map((e,s)=>(0,n.jsx)(r,{step:e,index:s,isLast:s===t.steps.length-1},e.id))})},ec=e=>{let{workflow:t,viewMode:s,onViewModeChange:r,onUpdateWorkflow:d}=e,[c,m]=(0,i.useState)(!1),[u,g]=(0,i.useState)(null),f=async()=>{m(!0);try{let e;e="paused"===t.status?await p(t.id):await h(t.id),d(e)}catch(e){console.error("Error updating workflow:",e)}finally{m(!1)}},y=async e=>{m(!0);try{let s=t.steps.findIndex(t=>t.id===e);if(-1===s)return;let n=await x(t.id,e,{status:"completed",progress:100,endTime:new Date});if(s<t.steps.length-1){let e=t.steps[s+1].id,i=await x(n.id,e,{status:"in-progress",progress:0,startTime:new Date});d(i)}else d(n)}catch(e){console.error("Error completing step:",e)}finally{m(!1)}},v=async()=>{if(u){m(!0);try{let e=await x(t.id,u.stepId,{notes:u.notes});d(e),g(null)}catch(e){console.error("Error updating notes:",e)}finally{m(!1)}}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.A,{sx:{mb:3},children:(0,n.jsxs)(A.A,{children:[(0,n.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,n.jsxs)(a.A,{children:[(0,n.jsx)(l.A,{variant:"h5",gutterBottom:!0,children:t.product}),(0,n.jsxs)(l.A,{variant:"body2",color:"text.secondary",children:[(0,n.jsx)(L.A,{sx:{fontSize:16,verticalAlign:"text-bottom",mr:.5}}),(0,G.GP)(new Date(t.startTime),"EEEE, d. MMMM yyyy")," • ","Workflow: ",t.name," (v",t.version,")"," • ","Charge: ",t.batchSize," • ","Verantwortlich: ",t.assignedTo]})]}),(0,n.jsxs)(a.A,{children:[(0,n.jsx)(o.A,{variant:"contained",startIcon:"paused"===t.status?(0,n.jsx)(T.A,{}):(0,n.jsx)(K.A,{}),color:"primary",sx:{mr:1},onClick:f,disabled:c||"completed"===t.status||"planned"===t.status,children:"paused"===t.status?"Fortsetzen":"Pausieren"}),(0,n.jsxs)(I.A,{size:"small",value:s,exclusive:!0,onChange:(e,t)=>t&&r(t),children:[(0,n.jsx)(B.A,{value:"table",children:(0,n.jsx)(O.A,{})}),(0,n.jsx)(B.A,{value:"timeline",children:(0,n.jsx)(R.A,{})})]})]})]}),(0,n.jsxs)(a.A,{sx:{display:"flex",gap:1,mt:1,mb:3},children:[(0,n.jsx)(b.A,{label:t.status,color:"completed"===t.status?"success":"in-progress"===t.status?"primary":"paused"===t.status?"warning":"default",sx:{textTransform:"capitalize"}}),"completed"!==t.status&&(0,n.jsx)(b.A,{label:"Fertig: ".concat((0,G.GP)(new Date(t.estimatedEndTime),"HH:mm 'Uhr'")),variant:"outlined"})]}),"table"===s?(0,n.jsx)(el,{steps:t.steps,onComplete:y,onEditNotes:e=>{g({stepId:e.id,notes:e.notes||""})},disabled:c||"paused"===t.status||"completed"===t.status}):(0,n.jsx)(ed,{workflow:t})]})}),(0,n.jsxs)(E.A,{open:null!==u,onClose:()=>g(null),children:[(0,n.jsx)(M.A,{children:"Notizen bearbeiten"}),(0,n.jsx)(F.A,{children:(0,n.jsx)(V.A,{fullWidth:!0,multiline:!0,rows:4,label:"Notizen",variant:"outlined",margin:"normal",value:(null==u?void 0:u.notes)||"",onChange:e=>g(t=>t?{...t,notes:e.target.value}:null)})}),(0,n.jsxs)(N.A,{children:[(0,n.jsx)(o.A,{onClick:()=>g(null),children:"Abbrechen"}),(0,n.jsx)(o.A,{onClick:v,variant:"contained",disabled:c,children:"Speichern"})]})]})]})};var em=s(54265),eu=s(77498),ex=s(80329),ep=s(7782),eh=s(50095);let eg=e=>{let{open:t,onClose:s,onSubmit:r}=e,[c,m]=(0,i.useState)(""),[u,x]=(0,i.useState)(""),[p,h]=(0,i.useState)(0),[g,j]=(0,i.useState)(""),[A,f]=(0,i.useState)(""),[y,v]=(0,i.useState)(""),[T,D]=(0,i.useState)(""),[z,S]=(0,i.useState)(!1),[k,C]=(0,i.useState)(null),[P,I]=(0,i.useState)(null),B=[{id:"franz",name:"Franz M\xfcller"},{id:"maria",name:"Maria Schmidt"},{id:"lisa",name:"Lisa Wagner"},{id:"thomas",name:"Thomas Weber"}],L=()=>{try{var e;let t;if(I(null),!c)return void I("Bitte w\xe4hlen Sie eine Vorlage aus");if(!u)return void I("Bitte geben Sie einen Produktnamen ein");if(p<=0)return void I("Die Menge muss gr\xf6\xdfer als 0 sein");if(!y)return void I("Bitte w\xe4hlen Sie einen Verantwortlichen aus");if(!g||!A)return void I("Bitte w\xe4hlen Sie Datum und Zeit aus");if("custom"===c&&!T.trim())return void I("Bitte geben Sie eine YAML-Definition ein");let s=new Date("".concat(g,"T").concat(A));if(isNaN(s.getTime()))return void I("Ung\xfcltiges Datum oder ung\xfcltige Zeit");if("custom"===c)try{t=_(T)}catch(e){I("Fehler beim Parsen der YAML-Definition");return}else t=_("croissant_production"===c?"# Beispiel f\xfcr Croissant-Prozess\nname: croissant_production\nversion: 1.2\nsteps:\n  - name: teig_vorbereiten\n    timeout: 30m\n    activities:\n      - mixen\n      - kneten\n  - name: erste_gehzeit\n    type: sleep\n    duration: 2h\n    conditions:\n      - temp > 22\xb0C: 1.5h\n  - name: formen\n    parallel:\n      - schneiden\n      - rollen\n  - name: zweite_gehzeit\n    type: sleep\n    duration: 1h\n  - name: backen\n    timeout: 20m\n    params:\n      temp: 190\xb0C":"name: ".concat(c,"\nversion: 1.0"));let n=W(t,s);n.product=u,n.batchSize=p,n.assignedTo=(null==(e=B.find(e=>e.id===y))?void 0:e.name)||"",C(n),S(!0)}catch(e){console.error("Error generating preview:",e),I("Ein Fehler ist aufgetreten beim Erstellen der Vorschau")}};if(!g){let e=new Date,t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");j("".concat(t,"-").concat(s,"-").concat(n));let i=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");f("".concat(i,":").concat(r))}return(0,n.jsxs)(E.A,{open:t,onClose:s,maxWidth:"md",fullWidth:!0,children:[(0,n.jsx)(M.A,{children:z?"Vorschau: Neuer Produktionsprozess":"Neuen Produktionsprozess erstellen"}),(0,n.jsxs)(F.A,{children:[P&&(0,n.jsx)(em.A,{severity:"error",sx:{mt:2,mb:2},children:P}),z?(0,n.jsxs)(a.A,{sx:{pt:2},children:[(0,n.jsxs)(U.A,{variant:"outlined",sx:{p:2,mb:3},children:[(0,n.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:k.product}),(0,n.jsx)(w.A,{sx:{my:1}}),(0,n.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,n.jsxs)(d.Ay,{item:!0,xs:6,children:[(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Workflow"}),(0,n.jsxs)(l.A,{variant:"body1",children:[k.name," v",k.version]})]}),(0,n.jsxs)(d.Ay,{item:!0,xs:6,children:[(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Menge"}),(0,n.jsxs)(l.A,{variant:"body1",children:[k.batchSize," Stk."]})]}),(0,n.jsxs)(d.Ay,{item:!0,xs:6,children:[(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Verantwortlich"}),(0,n.jsx)(l.A,{variant:"body1",children:k.assignedTo})]}),(0,n.jsxs)(d.Ay,{item:!0,xs:6,children:[(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Startzeit"}),(0,n.jsxs)(l.A,{variant:"body1",children:[g," um ",A," Uhr"]})]})]})]}),(0,n.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:"Prozessschritte"}),(0,n.jsx)(a.A,{sx:{mb:2},children:k.steps&&k.steps.length>0?k.steps.map((e,t)=>(0,n.jsxs)(U.A,{variant:"outlined",sx:{p:2,mb:1,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)(a.A,{children:[(0,n.jsxs)(l.A,{variant:"subtitle2",children:[t+1,". ",e.name.replace(/_/g," ")]}),"sleep"===e.type&&(0,n.jsx)(b.A,{label:"Ruhezeit",size:"small",color:"info",sx:{mr:1}}),e.duration&&(0,n.jsxs)(l.A,{variant:"body2",color:"text.secondary",children:["Dauer: ",e.duration]})]}),(0,n.jsx)(b.A,{label:"Ausstehend",size:"small",color:"default"})]},t)):(0,n.jsx)(l.A,{variant:"body2",color:"text.secondary",children:"Keine Prozessschritte definiert"})}),(0,n.jsx)(em.A,{severity:"info",children:"Dies ist eine Vorschau des Workflows. Klicken Sie auf 'Erstellen', um den Prozess zu starten."})]}):(0,n.jsx)(a.A,{sx:{pt:2},children:(0,n.jsxs)(d.Ay,{container:!0,spacing:3,children:[(0,n.jsx)(d.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsxs)(eu.A,{fullWidth:!0,children:[(0,n.jsx)(ex.A,{children:"Vorlage ausw\xe4hlen"}),(0,n.jsx)(ep.A,{value:c,label:"Vorlage ausw\xe4hlen",onChange:e=>m(e.target.value),children:[{id:"croissant_production",name:"Croissant Produktion"},{id:"sourdough_bread",name:"Sauerteigbrot"},{id:"baguette",name:"Baguette"},{id:"ciabatta",name:"Ciabatta"},{id:"custom",name:"Benutzerdefiniert"}].map(e=>(0,n.jsx)(eh.A,{value:e.id,children:e.name},e.id))})]})}),(0,n.jsx)(d.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(V.A,{fullWidth:!0,label:"Produkt",value:u,onChange:e=>x(e.target.value),placeholder:"z.B. Butter Croissants"})}),(0,n.jsx)(d.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(V.A,{fullWidth:!0,label:"Menge",type:"number",InputProps:{inputProps:{min:1}},value:p||"",onChange:e=>h(parseInt(e.target.value)||0),placeholder:"Anzahl der Einheiten"})}),(0,n.jsx)(d.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsxs)(eu.A,{fullWidth:!0,children:[(0,n.jsx)(ex.A,{children:"Verantwortlicher"}),(0,n.jsx)(ep.A,{value:y,label:"Verantwortlicher",onChange:e=>v(e.target.value),children:B.map(e=>(0,n.jsx)(eh.A,{value:e.id,children:e.name},e.id))})]})}),(0,n.jsx)(d.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(V.A,{fullWidth:!0,label:"Datum",type:"date",value:g,onChange:e=>j(e.target.value),InputLabelProps:{shrink:!0}})}),(0,n.jsx)(d.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(V.A,{fullWidth:!0,label:"Zeit",type:"time",value:A,onChange:e=>f(e.target.value),InputLabelProps:{shrink:!0}})}),"custom"===c&&(0,n.jsxs)(d.Ay,{item:!0,xs:12,children:[(0,n.jsx)(l.A,{variant:"subtitle2",gutterBottom:!0,children:"Workflow Definition (YAML)"}),(0,n.jsx)(V.A,{fullWidth:!0,multiline:!0,rows:10,value:T,onChange:e=>D(e.target.value),placeholder:"Geben Sie hier Ihre YAML-Definition ein",variant:"outlined",sx:{fontFamily:"monospace"}}),(0,n.jsx)(l.A,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:"Definieren Sie Ihren Workflow mit Schritten, Zeitangaben und Bedingungen"})]})]})})]}),(0,n.jsx)(N.A,{children:z?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.A,{onClick:()=>{S(!1),C(null),I(null)},children:"Zur\xfcck"}),(0,n.jsx)(o.A,{onClick:()=>{k?(r(k),s()):L()},variant:"contained",children:"Produktionsprozess erstellen"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.A,{onClick:s,children:"Abbrechen"}),(0,n.jsx)(o.A,{onClick:L,variant:"contained",children:"Vorschau"})]})})]})};var ej=s(13431);function eA(){let[e,t]=(0,i.useState)([]),[s,x]=(0,i.useState)(null),[p,h]=(0,i.useState)("table"),[g,j]=(0,i.useState)(0),[A,f]=(0,i.useState)(!1),[y,b]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{(async()=>{try{b(!0);let e=await u();t(e),e.length>0&&x(e[0])}catch(e){console.error("Failed to fetch workflows:",e)}finally{b(!1)}})()},[]),(0,n.jsx)(ej.A,{children:(0,n.jsxs)(r.A,{maxWidth:"xl",sx:{py:4,pt:2},children:[(0,n.jsxs)(a.A,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)(a.A,{children:[(0,n.jsx)(l.A,{variant:"h4",component:"h1",gutterBottom:!0,children:"B\xe4ckerei-Prozessmanagement"}),(0,n.jsx)(l.A,{variant:"body1",color:"text.secondary",children:"Verfolgen und verwalten Sie Ihre Produktionsprozesse in Echtzeit"})]}),(0,n.jsx)(o.A,{variant:"contained",startIcon:(0,n.jsx)(m.A,{}),onClick:()=>f(!0),children:"Neuer Prozess"})]}),(0,n.jsxs)(d.Ay,{container:!0,spacing:3,children:[(0,n.jsx)(d.Ay,{item:!0,xs:12,md:4,lg:3,children:(0,n.jsx)(P,{workflows:e,selectedWorkflow:s,activeTab:g,onTabChange:(e,t)=>{j(t)},onSelectWorkflow:e=>{x(e)}})}),(0,n.jsx)(d.Ay,{item:!0,xs:12,md:8,lg:9,children:y?(0,n.jsx)(a.A,{sx:{textAlign:"center",py:8},children:(0,n.jsx)(l.A,{children:"Lade Prozesse..."})}):s?(0,n.jsx)(ec,{workflow:s,viewMode:p,onViewModeChange:e=>{h(e)},onUpdateWorkflow:s=>{t(e.map(e=>e.id===s.id?s:e)),x(s)}}):(0,n.jsxs)(a.A,{sx:{textAlign:"center",py:8,bgcolor:"background.paper",borderRadius:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2},children:[(0,n.jsx)(l.A,{variant:"h6",children:"Keine Prozesse ausgew\xe4hlt"}),(0,n.jsx)(o.A,{variant:"outlined",startIcon:(0,n.jsx)(m.A,{}),onClick:()=>f(!0),children:"Neuen Prozess erstellen"})]})})]}),(0,n.jsx)(eg,{open:A,onClose:()=>f(!1),onSubmit:s=>{let n={...s,id:"wf-".concat(Date.now())};t([...e,n]),x(n),j(+("planned"===n.status)),f(!1)}}),(0,n.jsx)(a.A,{sx:{display:{sm:"none"}},children:(0,n.jsx)(c.A,{color:"primary","aria-label":"add",sx:{position:"fixed",bottom:16,right:16},onClick:()=>f(!0),children:(0,n.jsx)(m.A,{})})})]})})}},55128:(e,t,s)=>{Promise.resolve().then(s.bind(s,10780))}},e=>{var t=t=>e(e.s=t);e.O(0,[1091,4732,4829,6049,752,746,2502,1580,5183,7494,6415,3831,2245,2729,5405,5320,7277,6500,3431,8441,1684,7358],()=>t(55128)),_N_E=e.O()}]);