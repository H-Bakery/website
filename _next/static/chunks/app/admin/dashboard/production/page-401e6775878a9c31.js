(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7961],{25158:(e,t,a)=>{Promise.resolve().then(a.bind(a,51430))},27377:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i.createSvgIcon}});var i=a(90357)},28353:(e,t,a)=>{"use strict";var i=a(56620);t.A=void 0;var n=i(a(27377)),r=a(95155);t.A=(0,n.default)((0,r.jsx)("path",{d:"M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5m13.5-9 1.96 2.5H17V9.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"LocalShipping")},30651:(e,t,a)=>{"use strict";var i=a(56620);t.A=void 0;var n=i(a(27377)),r=a(95155);t.A=(0,n.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},34131:(e,t,a)=>{"use strict";var i=a(56620);t.A=void 0;var n=i(a(27377)),r=a(95155);t.A=(0,n.default)((0,r.jsx)("path",{d:"m20.38 8.57-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44zm-9.79 6.84a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83"}),"Speed")},41748:(e,t,a)=>{"use strict";var i=a(56620);t.A=void 0;var n=i(a(27377)),r=a(95155);t.A=(0,n.default)((0,r.jsx)("path",{d:"M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2m-5 12H9v-2h6zm5-7H4V4l16-.02z"}),"Inventory")},51430:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q});var i=a(95155),n=a(12115),r=a(63159),s=a(89915),l=a(16150),c=a(9670),d=a(19494),o=a(90746),u=a(91580),h=a(41748),m=a(28353),x=a(30651),p=a(34131),f=a(52661),g=a(43189),A=a(71214),y=a(22657),j=a(73746),v=a(80158),b=a(18203),k=a(83540),w=a(3401),_=a(94754),S=a(96025),P=a(16238),W=a(94517),z=a(24026),D=a(83394);let E=e=>{let{title:t,subtitle:a,data:n,valueLabel:r="Actual",targetLabel:s="Target",height:d=300,showTarget:o=!0}=e,u=(0,j.A)(),h=n.map((e,t)=>({...e,color:e.color||u.palette.primary.main}));return(0,i.jsxs)(b.A,{sx:{p:2,height:"100%",display:"flex",flexDirection:"column"},children:[(0,i.jsx)(c.A,{variant:"h6",component:"h3",gutterBottom:!0,children:t}),a&&(0,i.jsx)(c.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:a}),(0,i.jsx)(l.A,{sx:{flexGrow:1,width:"100%"},children:(0,i.jsx)(k.u,{width:"100%",height:d,children:(0,i.jsxs)(w.E,{data:h,layout:"vertical",margin:{top:5,right:30,left:20,bottom:5},children:[(0,i.jsx)(_.d,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,i.jsx)(S.W,{type:"number"}),(0,i.jsx)(P.h,{dataKey:"name",type:"category"}),(0,i.jsx)(W.m,{content:(0,i.jsx)(e=>{let{active:t,payload:a,label:n}=e;if(t&&a&&a.length){let e=a[0].payload,t=e.value,l=e.target||0,c=l?(t/l*100).toFixed(1):null;return(0,i.jsxs)("div",{style:{backgroundColor:"#fff",padding:"10px",border:"1px solid #ccc",borderRadius:"4px"},children:[(0,i.jsx)("p",{style:{margin:0,fontWeight:"bold"},children:"".concat(n)}),(0,i.jsx)("p",{style:{margin:"5px 0 0",color:a[0].color},children:"".concat(r,": ").concat(t)}),o&&l>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{style:{margin:"5px 0 0",color:u.palette.secondary.main},children:"".concat(s,": ").concat(l)}),(0,i.jsx)(v.A,{sx:{my:1}}),(0,i.jsx)("p",{style:{margin:0,fontWeight:"bold"},children:"Achievement: ".concat(c,"%")})]})]})}return null},{})}),(0,i.jsx)(z.s,{}),(0,i.jsx)(D.y,{dataKey:"value",name:r,fill:u.palette.primary.main,children:h.map((e,t)=>(0,i.jsx)(D.y,{dataKey:"value",fill:e.color},"bar-".concat(t)))}),o&&(0,i.jsx)(D.y,{dataKey:"target",name:s,fill:u.palette.secondary.main})]})})})]})};var K=a(78946);let q=()=>{let[e,t]=(0,n.useState)("day"),[a,j]=(0,n.useState)(!0),[v,b]=(0,n.useState)(null),[k,w]=(0,n.useState)([]),[_,S]=(0,n.useState)([]),[P,W]=(0,n.useState)([]),[z,D]=(0,n.useState)([]),[q,B]=(0,n.useState)([]),[C,F]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{j(!0),b(null);try{let t=await K.A.getProductionData(e);w(t);let a=await K.A.getInventoryData();S(a);let i=await K.A.getStaffData();W(i.filter(e=>"B\xe4ckermeister"===e.role||"B\xe4cker"===e.role||"Konditorin"===e.role));let n=await K.A.getTimeSeriesData("production",e);D(n);let r=await K.A.getTimeSeriesData("waste",e);B(r);let s=await K.A.getSummaryData(e);F(s)}catch(e){console.error("Error fetching production data:",e),b("Beim Laden der Produktionsdaten ist ein Fehler aufgetreten. Bitte versuchen Sie es sp\xe4ter erneut.")}finally{j(!1)}})()},[e]);let M=()=>_.filter(e=>e.quantity<=1.2*e.min_stock_level);return(0,i.jsx)(i.Fragment,{children:a?(0,i.jsx)(r.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:(0,i.jsx)(s.A,{})}):(0,i.jsxs)(r.A,{maxWidth:"xl",children:[(0,i.jsxs)(l.A,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"},children:[(0,i.jsx)(c.A,{variant:"h4",component:"h1",children:"Backstube: Produktions\xfcbersicht"}),(0,i.jsx)(f.A,{timeRange:e,onTimeRangeChange:e=>{t(e)}})]}),v&&(0,i.jsx)(d.A,{severity:"error",sx:{mb:4},onClose:()=>{b(null)},children:v}),C&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,i.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,i.jsx)(g.A,{title:"Gesamtproduktion",value:C.totalProduced,unit:" St\xfcck",icon:(0,i.jsx)(h.A,{}),color:"#4caf50",tooltip:"Gesamtzahl der produzierten Artikel im ausgew\xe4hlten Zeitraum"})}),(0,i.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,i.jsx)(g.A,{title:"Verkaufte Artikel",value:C.totalItems,unit:" St\xfcck",icon:(0,i.jsx)(m.A,{}),color:"#2196f3",tooltip:"Gesamtzahl der verkauften Artikel im ausgew\xe4hlten Zeitraum"})}),(0,i.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,i.jsx)(g.A,{title:"Ausschuss",value:C.totalWaste,unit:" St\xfcck",icon:(0,i.jsx)(x.A,{}),color:"#f44336",tooltip:"Gesamtmenge an Ausschuss im ausgew\xe4hlten Zeitraum"})}),(0,i.jsx)(o.Ay,{item:!0,xs:12,sm:6,md:3,children:(0,i.jsx)(g.A,{title:"Ausschussrate",value:C.wastageRate.toFixed(1),unit:"%",icon:(0,i.jsx)(p.A,{}),color:"#ff9800",tooltip:"Prozentsatz der Produktion, der verschwendet wurde"})})]}),M().length>0&&(0,i.jsxs)(d.A,{severity:"warning",sx:{mb:4},children:[(0,i.jsx)(c.A,{variant:"subtitle1",component:"div",sx:{fontWeight:"bold"},children:"Warnung: Niedriger Lagerbestand"}),(0,i.jsx)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:1},children:M().map(e=>(0,i.jsx)(u.A,{label:"".concat(e.name,": ").concat(e.quantity," ").concat(e.unit," verbleibend"),color:"warning",size:"small"},e.id))})]}),(0,i.jsxs)(o.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,i.jsx)(o.Ay,{item:!0,xs:12,md:8,children:(0,i.jsx)(A.A,{title:"Produktion & Ausschuss",subtitle:"Trends f\xfcr Produktion und Ausschuss im Zeitraum: ".concat(e),type:"line",data:(()=>{let e=[],t={};return z.forEach(e=>{t[e.date]={date:e.date,production:e.value,waste:0}}),q.forEach(e=>{t[e.date]?t[e.date].waste=e.value:t[e.date]={date:e.date,production:0,waste:e.value}}),Object.values(t).forEach(t=>e.push(t)),e.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),e})(),dataKeys:{x:"date",y:["production","waste"],colors:["#4caf50","#f44336"]},height:300})}),(0,i.jsx)(o.Ay,{item:!0,xs:12,md:4,children:(0,i.jsx)(A.A,{title:"Produktion nach Kategorie",subtitle:"Verteilung der Produkte nach Kategorie",type:"pie",data:(()=>{let e={};return k.forEach(t=>{let a=t.product_name,i="Sonstiges";a.includes("Brot")||a.includes("Baguette")?i="Brot":a.includes("Kuchen")||a.includes("T\xf6rtchen")?i="Kuchen":a.includes("Geb\xe4ck")||a.includes("Croissant")||a.includes("Br\xf6tchen")?i="Geb\xe4ck":a.includes("Torte")&&(i="Torten"),e[i]=(e[i]||0)+t.quantity_produced}),Object.entries(e).map(e=>{let[t,a]=e;return{name:t,value:a}})})(),dataKeys:{x:"name",y:"value",colors:["#4caf50","#2196f3","#ff9800","#9c27b0","#607d8b"]},height:300})})]}),(0,i.jsxs)(o.Ay,{container:!0,spacing:3,sx:{mb:4},children:[(0,i.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,i.jsx)(E,{title:"Mitarbeiterproduktivit\xe4t",subtitle:"Leistungsmetriken des Backstubenpersonals",data:P.map(e=>({name:e.name,value:e.productivity,target:90,color:e.productivity>=90?"#4caf50":e.productivity>=80?"#ff9800":"#f44336"})),valueLabel:"Produktivit\xe4tswert",targetLabel:"Zielwert",height:300})}),(0,i.jsx)(o.Ay,{item:!0,xs:12,md:6,children:(0,i.jsx)(y.A,{title:"Bestandsstatus",subtitle:"Aktuelle Lagerbest\xe4nde",columns:[{id:"name",label:"Zutat",minWidth:120},{id:"quantity",label:"Menge",minWidth:80,align:"right"},{id:"unit",label:"Einheit",minWidth:60},{id:"status",label:"Status",minWidth:100,align:"center",format:e=>(0,i.jsx)(u.A,{label:e,color:"Kritisch"===e?"error":"Nachbestellen"===e?"warning":"success",size:"small"})},{id:"last_restocked",label:"Letzte Auff\xfcllung",minWidth:120}],data:_.map(e=>({id:e.id,name:e.name,quantity:e.quantity,unit:e.unit,status:e.quantity<=e.min_stock_level?"Kritisch":e.quantity<=1.5*e.min_stock_level?"Nachbestellen":"OK",last_restocked:new Date(e.last_restocked).toLocaleDateString()})),searchEnabled:!0,emptyMessage:"Keine Bestandsdaten verf\xfcgbar"})})]}),(0,i.jsx)(o.Ay,{container:!0,spacing:3,children:(0,i.jsx)(o.Ay,{item:!0,xs:12,children:(0,i.jsx)(y.A,{title:"Produktionsaufzeichnungen",subtitle:"Detaillierte Produktionsdaten f\xfcr den ausgew\xe4hlten Zeitraum",columns:[{id:"date",label:"Datum",minWidth:100},{id:"product",label:"Produkt",minWidth:150},{id:"quantity",label:"Produziert",minWidth:100,align:"right"},{id:"waste",label:"Ausschuss",minWidth:100,align:"right"},{id:"efficiency",label:"Effizienz",minWidth:100,align:"right",format:e=>{let t=parseFloat(e),a="#4caf50";return t<90&&(a="#ff9800"),t<80&&(a="#f44336"),(0,i.jsx)(c.A,{component:"span",sx:{color:a,fontWeight:"medium"},children:e})}},{id:"staff",label:"Mitarbeiter",minWidth:120}],data:k.map(e=>({id:e.id,date:new Date(e.date).toLocaleDateString(),product:e.product_name,quantity:e.quantity_produced,waste:e.waste,staff:e.staff_name,efficiency:((e.quantity_produced-e.waste)/e.quantity_produced*100).toFixed(1)+"%"})),searchEnabled:!0,emptyMessage:"Keine Produktionsdaten f\xfcr den ausgew\xe4hlten Zeitraum verf\xfcgbar"})})})]})]})})}},90357:(e,t,a)=>{"use strict";a.r(t),a.d(t,{capitalize:()=>n.A,createChainedFunction:()=>r,createSvgIcon:()=>s.A,debounce:()=>l.A,deprecatedPropType:()=>c,isMuiElement:()=>d.A,ownerDocument:()=>o.A,ownerWindow:()=>u.A,requirePropFactory:()=>h,setRef:()=>m,unstable_ClassNameGenerator:()=>v,unstable_useEnhancedEffect:()=>x.A,unstable_useId:()=>p.A,unsupportedProp:()=>f,useControlled:()=>g.A,useEventCallback:()=>A.A,useForkRef:()=>y.A,useIsFocusVisible:()=>j.A});var i=a(11326),n=a(39571);let r=a(64816).A;var s=a(89019),l=a(90278);let c=function(e,t){return()=>null};var d=a(73668),o=a(65281),u=a(58316);a(79630);let h=function(e,t){return()=>null},m=a(31348).A;var x=a(31947),p=a(39485);let f=function(e,t,a,i,n){return null};var g=a(25974),A=a(3243),y=a(90701),j=a(26058);let v={configure:e=>{i.A.configure(e)}}}},e=>{var t=t=>e(e.s=t);e.O(0,[8460,1266,746,752,4756,413,2502,1580,4736,5183,9152,3831,2729,6565,4444,4017,9197,206,8946,164,8441,1684,7358],()=>t(25158)),_N_E=e.O()}]);