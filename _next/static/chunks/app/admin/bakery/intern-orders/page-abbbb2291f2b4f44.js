(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1242],{9319:(e,t,n)=>{Promise.resolve().then(n.bind(n,65497))},65497:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>J});var r=n(95155),i=n(12115);let a=[{id:"order-001",orderName:"Weekly Market Stock Replenish",description:"Restock vegetables, fruits, and packaging for the weekend market stall.",status:"pending",assignedTo:"John Doe",createdAt:new Date(Date.now()-2592e5).toISOString(),updatedAt:new Date(Date.now()-2592e5).toISOString(),createdBy:"Admin",items:[{itemName:"Carrots",itemQuantity:10,unit:"kg"},{itemName:"Apples",itemQuantity:20,unit:"kg"},{itemName:"Paper Bags (Large)",itemQuantity:100,unit:"pcs"}]},{id:"order-002",orderName:"Urgent Flour Delivery",description:"Need 50kg of Type 550 flour for special cake production.",status:"in-progress",assignedTo:"Jane Smith",createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date().toISOString(),createdBy:"Chef Baker",quantity:50,billImageUrl:"/assets/images/stock/flour_bill_example.jpg"},{id:"order-003",orderName:"Cleaning Supplies for Bakery",description:"Order standard cleaning supplies - detergent, sponges, paper towels.",status:"done",assignedTo:"Mike Lee",createdAt:new Date(Date.now()-6048e5).toISOString(),updatedAt:new Date(Date.now()-1728e5).toISOString(),createdBy:"Admin",items:[{itemName:"Detergent",itemQuantity:5,unit:"bottles"},{itemName:"Sponges",itemQuantity:10,unit:"packs"}],billImageUrl:"/assets/images/stock/cleaning_bill_example.png"},{id:"order-004",orderName:"Packaging for Online Orders",description:"Boxes and bubble wrap for shipping online customer orders.",status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdBy:"Sales Team"}],l={getAllInternOrders:async()=>(await new Promise(e=>setTimeout(e,300)),[...a]),addInternOrder:async e=>{await new Promise(e=>setTimeout(e,400));let t={...e,id:"order-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,7)),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return a.push(t),t},updateInternOrder:async(e,t)=>{await new Promise(e=>setTimeout(e,300));let n=a.findIndex(t=>t.id===e);if(-1===n)return null;let r={...a[n],...t,updatedAt:new Date().toISOString()};return a[n]=r,r}};var s=n(91580),d=n(18203),o=n(9670),c=n(15876),x=n(25949),u=n(72137),m=n(3967),h=n(33470),g=n(57236),p=n(26096),A=n(44146),j=n(16150),b=n(70556),v=n(83200),y=n(13806),f=n(72723),w=n(88828),S=n(85426),I=n(65451);let C=e=>{switch(e){case"pending":return(0,r.jsx)(s.A,{icon:(0,r.jsx)(f.A,{}),label:"Pending",color:"warning",size:"small",variant:"outlined"});case"in-progress":return(0,r.jsx)(s.A,{icon:(0,r.jsx)(w.A,{}),label:"In Progress",color:"info",size:"small",variant:"outlined"});case"done":return(0,r.jsx)(s.A,{icon:(0,r.jsx)(y.A,{}),label:"Done",color:"success",size:"small",variant:"outlined"});case"cancelled":return(0,r.jsx)(s.A,{icon:(0,r.jsx)(S.A,{}),label:"Cancelled",color:"error",size:"small",variant:"outlined"});default:return(0,r.jsx)(s.A,{label:e,size:"small",variant:"outlined"})}},k=e=>{let{orders:t,onEditOrder:n,onViewOrder:i,onMarkAsDone:a}=e;return 0===t.length?(0,r.jsxs)(d.A,{elevation:1,sx:{p:3,textAlign:"center"},children:[(0,r.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"No intern orders found."}),(0,r.jsx)(o.A,{variant:"body2",color:"text.secondary",children:"Create a new order to get started."})]}):(0,r.jsx)(c.A,{component:d.A,elevation:1,sx:{borderRadius:"8px"},children:(0,r.jsxs)(x.A,{sx:{minWidth:650},"aria-label":"intern orders table",children:[(0,r.jsx)(u.A,{sx:{bgcolor:"action.hover"},children:(0,r.jsxs)(m.A,{children:[(0,r.jsx)(h.A,{sx:{fontWeight:"bold"},children:"Order Name"}),(0,r.jsx)(h.A,{sx:{fontWeight:"bold"},children:"Status"}),(0,r.jsx)(h.A,{sx:{fontWeight:"bold"},children:"Assigned To"}),(0,r.jsx)(h.A,{sx:{fontWeight:"bold"},children:"Created At"}),(0,r.jsx)(h.A,{sx:{fontWeight:"bold"},children:"Items/Qty"}),(0,r.jsx)(h.A,{sx:{fontWeight:"bold"},children:"Bill"}),(0,r.jsx)(h.A,{sx:{fontWeight:"bold",textAlign:"center"},children:"Actions"})]})}),(0,r.jsx)(g.A,{children:t.map(e=>(0,r.jsxs)(m.A,{sx:{"&:last-child td, &:last-child th":{border:0},"&:hover":{backgroundColor:"action.selected"}},children:[(0,r.jsxs)(h.A,{component:"th",scope:"row",children:[(0,r.jsx)(o.A,{variant:"subtitle2",component:"div",children:e.orderName}),(0,r.jsx)(o.A,{variant:"caption",color:"text.secondary",sx:{display:"block",maxWidth:250,whiteSpace:"normal"},children:e.description})]}),(0,r.jsx)(h.A,{children:C(e.status)}),(0,r.jsx)(h.A,{children:e.assignedTo||"N/A"}),(0,r.jsx)(h.A,{children:new Date(e.createdAt).toLocaleDateString()}),(0,r.jsx)(h.A,{children:e.items&&e.items.length>0?"".concat(e.items.length," item(s)"):e.quantity?"".concat(e.quantity," (general)"):"N/A"}),(0,r.jsx)(h.A,{sx:{textAlign:"center"},children:e.billImageUrl?(0,r.jsx)(p.A,{title:"View Bill",children:(0,r.jsx)(A.A,{size:"small",onClick:()=>window.open(e.billImageUrl,"_blank"),children:(0,r.jsx)(I.A,{})})}):(0,r.jsx)(o.A,{variant:"caption",color:"text.disabled",children:"No Bill"})}),(0,r.jsx)(h.A,{sx:{textAlign:"center"},children:(0,r.jsxs)(j.A,{sx:{display:"flex",justifyContent:"center",gap:.5},children:[i&&(0,r.jsx)(p.A,{title:"View Details",children:(0,r.jsx)(A.A,{size:"small",onClick:()=>i(e),color:"primary",children:(0,r.jsx)(v.A,{})})}),(0,r.jsx)(p.A,{title:"Edit Order",children:(0,r.jsx)(A.A,{size:"small",onClick:()=>n(e),color:"secondary",children:(0,r.jsx)(b.A,{})})}),"done"!==e.status&&"cancelled"!==e.status&&(0,r.jsx)(p.A,{title:"Mark as Done",children:(0,r.jsx)(A.A,{size:"small",onClick:()=>a(e.id),color:"success",children:(0,r.jsx)(y.A,{})})})]})})]},e.id))})]})})};var O=n(90746),N=n(32582),D=n(77498),W=n(80329),B=n(26403),P=n(50095),T=n(95439),U=n(40463),z=n(34152),Q=n(74454),R=n(55857),_=n(4499),q=n(30651),E=n(31472);let F=e=>{let{order:t,onSubmit:n,onCancel:a}=e,[l,s]=(0,i.useState)(""),[c,x]=(0,i.useState)(""),[u,m]=(0,i.useState)(""),[h,g]=(0,i.useState)("pending"),[b,v]=(0,i.useState)(""),[y,f]=(0,i.useState)(null),[w,S]=(0,i.useState)(null),[I,C]=(0,i.useState)([]),[k,F]=(0,i.useState)(""),[L,M]=(0,i.useState)(""),[H,G]=(0,i.useState)("");(0,i.useEffect)(()=>{t?(s(t.orderName),x(t.description),m(t.quantity||""),g(t.status),v(t.assignedTo||""),S(t.billImageUrl||null),C(t.items||[])):(s(""),x(""),m(""),g("pending"),v(""),f(null),S(null),C([]))},[t]);let J=e=>{C(I.filter((t,n)=>n!==e))};return(0,r.jsxs)(d.A,{elevation:2,sx:{p:{xs:2,md:3},borderRadius:"12px"},children:[(0,r.jsx)(o.A,{variant:"h5",component:"h2",gutterBottom:!0,sx:{fontWeight:"bold",mb:3},children:t?"Edit Intern Order":"Create New Intern Order"}),(0,r.jsx)("form",{onSubmit:e=>{e.preventDefault(),n({orderName:l,description:c,status:h,assignedTo:b||void 0,billImageUrl:y?w||void 0:(null==t?void 0:t.billImageUrl)||void 0,items:I.length>0?I:void 0,quantity:u?Number(u):void 0})},children:(0,r.jsxs)(O.Ay,{container:!0,spacing:3,children:[(0,r.jsx)(O.Ay,{item:!0,xs:12,sm:6,children:(0,r.jsx)(N.A,{label:"Order Name",value:l,onChange:e=>s(e.target.value),fullWidth:!0,required:!0,variant:"outlined"})}),(0,r.jsx)(O.Ay,{item:!0,xs:12,sm:6,children:(0,r.jsxs)(D.A,{fullWidth:!0,variant:"outlined",children:[(0,r.jsx)(W.A,{id:"status-label",children:"Status"}),(0,r.jsxs)(B.A,{labelId:"status-label",value:h,onChange:e=>g(e.target.value),label:"Status",required:!0,children:[(0,r.jsx)(P.A,{value:"pending",children:"Pending"}),(0,r.jsx)(P.A,{value:"in-progress",children:"In Progress"}),(0,r.jsx)(P.A,{value:"done",children:"Done"}),(0,r.jsx)(P.A,{value:"cancelled",children:"Cancelled"})]})]})}),(0,r.jsx)(O.Ay,{item:!0,xs:12,children:(0,r.jsx)(N.A,{label:"Description",value:c,onChange:e=>x(e.target.value),fullWidth:!0,multiline:!0,rows:3,required:!0,variant:"outlined"})}),(0,r.jsx)(O.Ay,{item:!0,xs:12,sm:6,children:(0,r.jsx)(N.A,{label:"Assigned To (Optional)",value:b,onChange:e=>v(e.target.value),fullWidth:!0,variant:"outlined"})}),(0,r.jsx)(O.Ay,{item:!0,xs:12,sm:6,children:(0,r.jsx)(N.A,{label:"General Quantity (Optional, if no specific items)",type:"number",value:u,onChange:e=>m(""===e.target.value?"":Number(e.target.value)),fullWidth:!0,variant:"outlined",inputProps:{min:1}})}),(0,r.jsxs)(O.Ay,{item:!0,xs:12,children:[(0,r.jsx)(o.A,{variant:"h6",gutterBottom:!0,sx:{mt:2,fontWeight:500},children:"Items (Optional)"}),(0,r.jsx)(T.A,{dense:!0,children:I.map((e,t)=>(0,r.jsxs)(U.Ay,{divider:!0,sx:{bgcolor:t%2?"action.hover":"transparent",borderRadius:"4px",mb:.5,p:1},children:[(0,r.jsx)(z.A,{primary:e.itemName,secondary:"Qty: ".concat(e.itemQuantity," ").concat(e.unit||"")}),(0,r.jsx)(Q.A,{children:(0,r.jsx)(p.A,{title:"Remove Item",children:(0,r.jsx)(A.A,{edge:"end","aria-label":"delete",onClick:()=>J(t),color:"error",children:(0,r.jsx)(q.A,{})})})})]},t))}),(0,r.jsxs)(j.A,{sx:{display:"flex",alignItems:"center",gap:1,mt:+(I.length>0),p:1,border:"1px dashed",borderColor:"divider",borderRadius:"4px"},children:[(0,r.jsx)(N.A,{label:"Item Name",value:k,onChange:e=>F(e.target.value),size:"small",sx:{flexGrow:1}}),(0,r.jsx)(N.A,{label:"Qty",type:"number",value:L,onChange:e=>M(""===e.target.value?"":Number(e.target.value)),size:"small",sx:{width:"80px"},inputProps:{min:1}}),(0,r.jsx)(N.A,{label:"Unit",value:H,onChange:e=>G(e.target.value),size:"small",sx:{width:"100px"}}),(0,r.jsx)(p.A,{title:"Add Item",children:(0,r.jsx)("span",{children:(0,r.jsx)(A.A,{onClick:()=>{k&&L>0&&(C([...I,{itemName:k,itemQuantity:Number(L),unit:H}]),F(""),M(""),G(""))},color:"primary",disabled:!k||!L||0>=Number(L),children:(0,r.jsx)(_.A,{})})})})]})]}),(0,r.jsxs)(O.Ay,{item:!0,xs:12,children:[(0,r.jsx)(o.A,{variant:"h6",gutterBottom:!0,sx:{mt:2,fontWeight:500},children:"Bill Image (Optional)"}),(0,r.jsxs)(R.A,{variant:"outlined",component:"label",startIcon:(0,r.jsx)(E.A,{}),fullWidth:!0,sx:{py:1.5},children:["Upload Bill Image",(0,r.jsx)("input",{type:"file",hidden:!0,accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0];f(t),S(URL.createObjectURL(t))}}})]}),w&&(0,r.jsxs)(j.A,{sx:{mt:2,textAlign:"center"},children:[(0,r.jsx)(o.A,{variant:"caption",children:"Image Preview:"}),(0,r.jsx)("img",{src:w,alt:"Bill preview",style:{maxHeight:"150px",maxWidth:"100%",marginTop:"8px",borderRadius:"4px",border:"1px solid #ddd"}})]}),!y&&(null==t?void 0:t.billImageUrl)&&!w&&(0,r.jsxs)(j.A,{sx:{mt:2,textAlign:"center"},children:[(0,r.jsx)(o.A,{variant:"caption",children:"Current Bill Image:"}),(0,r.jsx)("img",{src:t.billImageUrl,alt:"Current bill",style:{maxHeight:"150px",maxWidth:"100%",marginTop:"8px",borderRadius:"4px",border:"1px solid #ddd"}})]})]}),(0,r.jsx)(O.Ay,{item:!0,xs:12,sx:{mt:3},children:(0,r.jsxs)(j.A,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[(0,r.jsx)(R.A,{variant:"outlined",color:"secondary",onClick:a,children:"Cancel"}),(0,r.jsx)(R.A,{type:"submit",variant:"contained",color:"primary",children:t?"Save Changes":"Create Order"})]})})]})})]})};var L=n(63159),M=n(89915),H=n(19494),G=n(9815);function J(){let[e,t]=(0,i.useState)([]),[n,a]=(0,i.useState)(!0),[s,c]=(0,i.useState)(null),[x,u]=(0,i.useState)(!1),[m,h]=(0,i.useState)(null),g=(0,i.useCallback)(async()=>{try{a(!0),c(null);let e=await l.getAllInternOrders();t(e)}catch(e){console.error("Failed to fetch intern orders:",e),c("Failed to load intern orders. Please try again later.")}finally{a(!1)}},[]);(0,i.useEffect)(()=>{g()},[g]);let p=async e=>{try{a(!0),m?await l.updateInternOrder(m.id,e):await l.addInternOrder(e),u(!1),h(null),await g()}catch(e){console.error("Failed to save intern order:",e),c("Failed to save intern order. Please check the details and try again.")}finally{s||a(!1)}},A=async e=>{try{a(!0),await l.updateInternOrder(e,{status:"done"}),await g()}catch(e){console.error("Failed to mark order as done:",e),c("Failed to update order status.")}finally{a(!1)}};return n&&0===e.length?(0,r.jsx)(L.A,{maxWidth:"lg",sx:{py:4,display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:(0,r.jsx)(M.A,{})}):(0,r.jsxs)(L.A,{maxWidth:"lg",sx:{py:{xs:2,md:4}},children:[s&&(0,r.jsx)(H.A,{severity:"error",sx:{mb:2},onClose:()=>c(null),children:s}),x?(0,r.jsx)(F,{order:m,onSubmit:p,onCancel:()=>{u(!1),h(null)}}):(0,r.jsxs)(d.A,{elevation:0,sx:{p:{xs:1,md:2},backgroundColor:"transparent"},children:[(0,r.jsxs)(j.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:{xs:2,md:3},flexWrap:"wrap",gap:1},children:[(0,r.jsx)(o.A,{variant:"h4",component:"h1",sx:{fontWeight:"medium"},children:"Intern Orders"}),(0,r.jsx)(R.A,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(G.A,{}),onClick:()=>{h(null),u(!0)},disabled:n,children:"New Intern Order"})]}),n&&(0,r.jsx)(M.A,{size:24,sx:{position:"absolute",top:"90px",right:"40px"}}),(0,r.jsx)(k,{orders:e,onEditOrder:e=>{h(e),u(!0)},onMarkAsDone:A})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8460,9670,7009,752,4756,413,2502,1580,5183,9152,6396,6277,6565,457,9453,8441,1684,7358],()=>t(9319)),_N_E=e.O()}]);