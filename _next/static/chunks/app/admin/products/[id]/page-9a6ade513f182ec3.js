(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7727],{11056:(e,t,i)=>{"use strict";i.d(t,{default:()=>I});var n=i(95155),s=i(12115),a=i(35695),r=i(91767),l=i(63159),d=i(89915),o=i(19494),c=i(55857),u=i(18203),m=i(16150),x=i(44146),h=i(9670),p=i(90746),g=i(16537),A=i(32582),v=i(70680),j=i(76898),y=i(9520),b=i(60538),f=i(57657),k=i(85426),C=i(51226),P=i(78946);let S={name:"",category:"",price:void 0,stock:void 0,dailyTarget:void 0,description:"",image:"",isActive:!0};function I(e){var t,i,I,T,z,E,W,D;let{productId:N}=e,_=(0,a.useRouter)(),w=parseInt(N,10),F=(0,r.useQueryClient)(),[Q,L]=(0,s.useState)(S),[O,q]=(0,s.useState)(S),[R,B]=(0,s.useState)(!1),[J,H]=(0,s.useState)(null),[M,U]=(0,s.useState)(null),[G,K]=(0,s.useState)(!1),{data:V,isLoading:X,isError:Y,error:Z}=(0,r.useQuery)(["product",w],()=>P.A.getProductById(w),{enabled:!!w,onSuccess:e=>{L(e),q(e),B(!1),K(!1)},onError:()=>{H("Failed to load product data.")}}),$=(0,r.useMutation)(e=>P.A.updateProduct(e.id,e.data),{onSuccess:e=>{U("Product updated successfully!"),H(null),F.invalidateQueries("adminProducts"),F.setQueryData(["product",w],e),L(e),q(e),B(!1),setTimeout(()=>U(null),3e3)},onError:e=>{H("Failed to update product: ".concat(e.message)),U(null)}});(0,s.useEffect)(()=>{JSON.stringify(Q)!==JSON.stringify(O)?B(!0):B(!1)},[Q,O]);let ee=e=>{let{name:t,value:i,type:n}=e.target;L(e=>({...e,[t]:"number"===n?""===i?void 0:parseFloat(i):i}))};return X?(0,n.jsx)(l.A,{sx:{mt:4,display:"flex",justifyContent:"center"},children:(0,n.jsx)(d.A,{})}):Y||!V?(0,n.jsxs)(l.A,{sx:{mt:4},children:[(0,n.jsx)(o.A,{severity:"error",children:(null==Z?void 0:Z.message)||"Product not found or failed to load."}),(0,n.jsx)(c.A,{startIcon:(0,n.jsx)(b.A,{}),onClick:()=>_.push("/admin/products"),sx:{mt:2},children:"Back to Products"})]}):(0,n.jsx)(l.A,{maxWidth:"md",sx:{mt:2,mb:4},children:(0,n.jsxs)(u.A,{elevation:3,sx:{p:{xs:2,sm:3}},children:[(0,n.jsxs)(m.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,n.jsx)(x.A,{onClick:()=>_.back(),"aria-label":"back",children:(0,n.jsx)(b.A,{})}),(0,n.jsxs)(h.A,{variant:"h5",component:"h1",sx:{ml:1},children:["Edit Product: ",O.name||"ID: ".concat(w)]})]}),M&&(0,n.jsx)(o.A,{severity:"success",sx:{mb:2},children:M}),J&&(0,n.jsx)(o.A,{severity:"error",sx:{mb:2},children:J}),(0,n.jsxs)(p.Ay,{container:!0,spacing:3,children:[(0,n.jsx)(p.Ay,{item:!0,xs:12,md:4,children:(0,n.jsxs)(m.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[G||!Q.image?(0,n.jsx)(g.A,{sx:{width:180,height:180,mb:2,fontSize:"4rem"},variant:"rounded",children:(0,n.jsx)(C.A,{fontSize:"inherit"})}):(0,n.jsx)(m.A,{component:"img",src:Q.image,alt:Q.name||"Product Image",onError:()=>{K(!0)},sx:{width:"100%",maxWidth:"180px",height:"auto",maxHeight:"180px",objectFit:"contain",borderRadius:1,mb:2,border:"1px solid #ddd"}}),(0,n.jsx)(A.A,{label:"Image URL",name:"image",value:null!=(t=Q.image)?t:"",onChange:ee,fullWidth:!0,variant:"outlined",size:"small"})]})}),(0,n.jsx)(p.Ay,{item:!0,xs:12,md:8,children:(0,n.jsxs)(p.Ay,{container:!0,spacing:2,children:[(0,n.jsx)(p.Ay,{item:!0,xs:12,children:(0,n.jsx)(A.A,{label:"Product Name",name:"name",value:null!=(i=Q.name)?i:"",onChange:ee,fullWidth:!0,required:!0,variant:"outlined",size:"small"})}),(0,n.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(A.A,{label:"Category",name:"category",value:null!=(I=Q.category)?I:"",onChange:ee,fullWidth:!0,variant:"outlined",size:"small"})}),(0,n.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(A.A,{label:"Price",name:"price",type:"number",value:null!=(T=Q.price)?T:"",onChange:ee,fullWidth:!0,required:!0,variant:"outlined",size:"small",InputProps:{startAdornment:(0,n.jsx)(v.A,{position:"start",children:"â‚¬"}),inputProps:{min:0,step:.01}}})}),(0,n.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(A.A,{label:"Stock Quantity",name:"stock",type:"number",value:null!=(z=Q.stock)?z:"",onChange:ee,fullWidth:!0,variant:"outlined",size:"small",InputProps:{inputProps:{min:0,step:1}}})}),(0,n.jsx)(p.Ay,{item:!0,xs:12,sm:6,children:(0,n.jsx)(A.A,{label:"Daily Target",name:"dailyTarget",type:"number",value:null!=(E=Q.dailyTarget)?E:"",onChange:ee,fullWidth:!0,variant:"outlined",size:"small",InputProps:{inputProps:{min:0,step:1}}})}),(0,n.jsx)(p.Ay,{item:!0,xs:12,children:(0,n.jsx)(A.A,{label:"Description",name:"description",value:null!=(W=Q.description)?W:"",onChange:ee,fullWidth:!0,multiline:!0,rows:3,variant:"outlined",size:"small"})}),(0,n.jsx)(p.Ay,{item:!0,xs:12,children:(0,n.jsx)(j.A,{control:(0,n.jsx)(y.A,{checked:null==(D=Q.isActive)||D,onChange:e=>{L(t=>({...t,[e.target.name]:e.target.checked}))},name:"isActive"}),label:"Product is Active"})})]})}),(0,n.jsx)(p.Ay,{item:!0,xs:12,children:(0,n.jsxs)(m.A,{sx:{display:"flex",justifyContent:"flex-end",mt:2},children:[(0,n.jsx)(c.A,{variant:"outlined",onClick:()=>{L(O),B(!1),H(null),_.back()},startIcon:(0,n.jsx)(k.A,{}),sx:{mr:2},disabled:$.isLoading,children:"Cancel"}),(0,n.jsx)(c.A,{variant:"contained",color:"primary",onClick:()=>{var e;if(!w)return;if(!Q.name||""===Q.name.trim())return void H("Product name is required.");if(void 0===Q.price||Q.price<0)return void H("Price must be a non-negative number.");if(void 0!==Q.stock&&Q.stock<0)return void H("Stock must be a non-negative number.");if(void 0!==Q.dailyTarget&&Q.dailyTarget<0)return void H("Daily Target must be a non-negative number.");H(null);let t={...Q,price:parseFloat(String(null!=(e=Q.price)?e:0)),stock:void 0!==Q.stock?parseInt(String(Q.stock),10):0,dailyTarget:void 0!==Q.dailyTarget?parseInt(String(Q.dailyTarget),10):0};delete t.id,$.mutate({id:w,data:t})},startIcon:(0,n.jsx)(f.A,{}),disabled:!R||$.isLoading||X,children:"Save Changes"})]})})]})]})})}},12624:(e,t,i)=>{Promise.resolve().then(i.bind(i,11056))}},e=>{var t=t=>e(e.s=t);e.O(0,[8460,9670,7009,752,4756,413,2502,5183,9152,2582,9520,1767,3792,9784,8946,8441,1684,7358],()=>t(12624)),_N_E=e.O()}]);