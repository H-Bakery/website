(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1778],{16406:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});var l=i(95155),r=i(16150),n=i(3998);let a=e=>{let{children:t}=e;return(0,l.jsxs)(r.A,{sx:{background:"radial-gradient(143.25% 143.25% at 50% 100%, #FFFFFF 0%, rgba(255, 255, 255, 0) 100%), #D8E1F4"},children:[(0,l.jsx)(n.Y,{}),(0,l.jsx)(r.A,{sx:{minHeight:"calc(100vh - 332px)"},children:t})]})}},22657:(e,t,i)=>{"use strict";i.d(t,{A:()=>p});var l=i(95155),r=i(12115),n=i(18203),a=i(16150),s=i(9670),d=i(73831),o=i(70680),c=i(15876),u=i(25949),m=i(72137),h=i(3967),x=i(33470),A=i(57236),j=i(63690),g=i(86192);let p=e=>{let{title:t,subtitle:i,columns:p,data:y,searchEnabled:v=!1,emptyMessage:b="No data available"}=e,[f,C]=(0,r.useState)(0),[P,k]=(0,r.useState)(5),[w,S]=(0,r.useState)(""),N=v&&w?y.filter(e=>Object.values(e).some(e=>null!=e&&e.toString().toLowerCase().includes(w.toLowerCase()))):y,D=N.slice(f*P,f*P+P);return(0,l.jsxs)(n.A,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,l.jsxs)(a.A,{sx:{p:2,pb:v?1:2},children:[(0,l.jsx)(s.A,{variant:"h6",component:"h3",children:t}),i&&(0,l.jsx)(s.A,{variant:"body2",color:"text.secondary",children:i}),v&&(0,l.jsx)(d.A,{margin:"dense",placeholder:"Search...",fullWidth:!0,variant:"outlined",size:"small",value:w,onChange:e=>S(e.target.value),InputProps:{startAdornment:(0,l.jsx)(o.A,{position:"start",children:(0,l.jsx)(g.A,{})})},sx:{mt:1}})]}),(0,l.jsx)(c.A,{sx:{flexGrow:1,overflow:"auto"},children:(0,l.jsxs)(u.A,{stickyHeader:!0,"aria-label":"".concat(t," table"),size:"small",children:[(0,l.jsx)(m.A,{children:(0,l.jsx)(h.A,{children:p.map(e=>(0,l.jsx)(x.A,{align:e.align,style:{minWidth:e.minWidth,fontWeight:"bold"},children:e.label},e.id))})}),(0,l.jsx)(A.A,{children:D.length>0?D.map((e,t)=>(0,l.jsx)(h.A,{hover:!0,tabIndex:-1,children:p.map(t=>{let i=e[t.id];return(0,l.jsx)(x.A,{align:t.align,children:t.format?t.format(i):i},t.id)})},t)):(0,l.jsx)(h.A,{children:(0,l.jsx)(x.A,{colSpan:p.length,align:"center",children:b})})})]})}),(0,l.jsx)(j.A,{rowsPerPageOptions:[5,10,25],component:"div",count:N.length,rowsPerPage:P,page:f,onPageChange:(e,t)=>{C(t)},onRowsPerPageChange:e=>{k(+e.target.value),C(0)}})]})}},33461:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});var l=i(95155),r=i(55857);i(12115);let n=e=>{let{children:t,...i}=e;return(0,l.jsx)(r.A,{variant:"contained",...i,children:t})}},52932:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>$});var l=i(95155),r=i(12115),n=i(63159),a=i(89915),s=i(91580),d=i(16150),o=i(54265),c=i(55965),u=i(13431),m=i(35695),h=i(9815),x=i(16406),A=i(33461),j=i(22657),g=i(78946),p=i(18203),y=i(9670),v=i(90746),b=i(73831),f=i(77498),C=i(80329),P=i(7782),k=i(50095),w=i(80158),S=i(55857),N=i(95439),D=i(14995),I=i(44146),W=i(34152),E=i(30651),O=i(85811);let F=e=>{let{products:t,order:i,onSave:n,onCancel:a}=e,[s,o]=(0,r.useState)({customerName:(null==i?void 0:i.customerName)||"",customerPhone:(null==i?void 0:i.customerPhone)||"",customerEmail:(null==i?void 0:i.customerEmail)||"",pickupDate:(e=>e?(e instanceof Date?e:new Date(e)).toISOString().slice(0,16):new Date(Date.now()+864e5).toISOString().slice(0,16))(null==i?void 0:i.pickupDate),status:(null==i?void 0:i.status)||"Pending",notes:(null==i?void 0:i.notes)||"",items:(null==i?void 0:i.items)?[...i.items]:[],totalPrice:(null==i?void 0:i.totalPrice)||0}),[c,u]=(0,r.useState)({productId:"",productName:"",quantity:1,unitPrice:0});(0,r.useEffect)(()=>{let e=(Array.isArray(s.items)?s.items:[]).reduce((e,t)=>e+t.quantity*t.unitPrice,0);o(t=>({...t,totalPrice:parseFloat(e.toFixed(2))}))},[s.items]);let m=e=>{let{name:t,value:i}=e.target;o({...s,[t]:i})},h=e=>{let t=[...s.items];t.splice(e,1),o({...s,items:t})};return(0,l.jsxs)(p.A,{sx:{p:3,mb:4},children:[(0,l.jsx)(y.A,{variant:"h5",gutterBottom:!0,children:i?"Edit Order":"New Order"}),(0,l.jsx)("form",{onSubmit:e=>{e.preventDefault(),n(s)},children:(0,l.jsxs)(v.Ay,{container:!0,spacing:3,children:[(0,l.jsx)(v.Ay,{item:!0,xs:12,children:(0,l.jsx)(y.A,{variant:"h6",sx:{mb:2},children:"Customer Information"})}),(0,l.jsx)(v.Ay,{item:!0,xs:12,md:4,children:(0,l.jsx)(b.A,{required:!0,fullWidth:!0,label:"Customer Name",name:"customerName",value:s.customerName,onChange:m})}),(0,l.jsx)(v.Ay,{item:!0,xs:12,md:4,children:(0,l.jsx)(b.A,{fullWidth:!0,label:"Phone Number",name:"customerPhone",value:s.customerPhone,onChange:m})}),(0,l.jsx)(v.Ay,{item:!0,xs:12,md:4,children:(0,l.jsx)(b.A,{fullWidth:!0,label:"Email",name:"customerEmail",type:"email",value:s.customerEmail,onChange:m})}),(0,l.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,l.jsx)(b.A,{fullWidth:!0,label:"Pickup Date",name:"pickupDate",type:"datetime-local",value:s.pickupDate,onChange:m,InputLabelProps:{shrink:!0},required:!0})}),(0,l.jsx)(v.Ay,{item:!0,xs:12,md:6,children:(0,l.jsxs)(f.A,{fullWidth:!0,required:!0,children:[(0,l.jsx)(C.A,{children:"Order Status"}),(0,l.jsxs)(P.A,{name:"status",value:s.status,onChange:e=>{let{name:t,value:i}=e.target;o({...s,[t]:i})},label:"Order Status",children:[(0,l.jsx)(k.A,{value:"Pending",children:"Pending"}),(0,l.jsx)(k.A,{value:"Confirmed",children:"Confirmed"}),(0,l.jsx)(k.A,{value:"Completed",children:"Completed"}),(0,l.jsx)(k.A,{value:"Cancelled",children:"Cancelled"})]})]})}),(0,l.jsx)(v.Ay,{item:!0,xs:12,children:(0,l.jsx)(b.A,{fullWidth:!0,multiline:!0,rows:2,label:"Order Notes",name:"notes",value:s.notes,onChange:m})}),(0,l.jsxs)(v.Ay,{item:!0,xs:12,children:[(0,l.jsx)(w.A,{sx:{my:2}}),(0,l.jsx)(y.A,{variant:"h6",sx:{mb:2},children:"Order Items"}),(0,l.jsxs)(v.Ay,{container:!0,spacing:2,sx:{mb:2},children:[(0,l.jsx)(v.Ay,{item:!0,xs:12,md:5,children:(0,l.jsxs)(f.A,{fullWidth:!0,children:[(0,l.jsx)(C.A,{children:"Product"}),(0,l.jsx)(P.A,{value:c.productId.toString(),onChange:e=>{let i=e.target.value,l=t.find(e=>e.id.toString()===i.toString());l&&u({...c,productId:i,productName:l.name,unitPrice:l.price})},label:"Product",children:t.map(e=>(0,l.jsxs)(k.A,{value:e.id.toString(),children:[e.name," - $",e.price.toFixed(2)]},e.id))})]})}),(0,l.jsx)(v.Ay,{item:!0,xs:12,md:3,children:(0,l.jsx)(b.A,{fullWidth:!0,type:"number",label:"Quantity",name:"quantity",value:c.quantity,onChange:e=>{let{name:t,value:i}=e.target,l=parseInt(i,10);isNaN(l)||u({...c,[t]:l})},inputProps:{min:1}})}),(0,l.jsx)(v.Ay,{item:!0,xs:12,md:4,children:(0,l.jsx)(S.A,{variant:"contained",startIcon:(0,l.jsx)(O.A,{}),onClick:()=>{c.productId&&(o({...s,items:[...s.items,{...c}]}),u({productId:"",productName:"",quantity:1,unitPrice:0}))},disabled:!c.productId,fullWidth:!0,sx:{height:"100%"},children:"Add Item"})})]}),(0,l.jsx)(p.A,{variant:"outlined",sx:{maxHeight:"300px",overflow:"auto"},children:(0,l.jsx)(N.A,{children:s.items.length>0?s.items.map((e,t)=>(0,l.jsx)(D.Ay,{secondaryAction:(0,l.jsx)(I.A,{edge:"end",onClick:()=>h(t),children:(0,l.jsx)(E.A,{color:"error"})}),divider:t<s.items.length-1,children:(0,l.jsx)(W.A,{primary:e.productName,secondary:"".concat(e.quantity," \xd7 $").concat(e.unitPrice.toFixed(2)," = $").concat((e.quantity*e.unitPrice).toFixed(2))})},t)):(0,l.jsx)(D.Ay,{children:(0,l.jsx)(W.A,{primary:"No items added to this order yet."})})})}),(0,l.jsx)(d.A,{sx:{mt:2,textAlign:"right"},children:(0,l.jsxs)(y.A,{variant:"h6",children:["Total: $",s.totalPrice.toFixed(2)]})})]}),(0,l.jsxs)(v.Ay,{item:!0,xs:12,children:[(0,l.jsx)(w.A,{sx:{my:2}}),(0,l.jsxs)(d.A,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[(0,l.jsx)(A.A,{onClick:a,type:"button",color:"secondary",children:"Cancel"}),(0,l.jsx)(A.A,{type:"submit",children:"Save Order"})]})]})]})})]})},q=e=>({...e,status:e.status}),z=()=>({customerName:"",items:[],totalPrice:0,status:"Pending",pickupDate:new Date().toISOString()}),$=()=>{let e=(0,m.useRouter)(),[t,i]=(0,r.useState)(!0),[p,y]=(0,r.useState)([]),[v,b]=(0,r.useState)([]),[f,C]=(0,r.useState)(!1),[P,k]=(0,r.useState)(null),[w,S]=(0,r.useState)(null),N=(0,r.useCallback)(async()=>{try{let[e,t]=await Promise.all([g.A.getOrders(),g.A.getProducts()]);y(e),b(t)}catch(t){let e=t instanceof Error?t.message:"An unknown error occurred";console.error("Error fetching data:",e),S("Failed to load data: ".concat(e))}finally{i(!1)}},[]);(0,r.useEffect)(()=>{N()},[N]);let D=(0,r.useCallback)(()=>{e.push("/dashboard")},[e]),I=(0,r.useCallback)(()=>{k(null),C(!0)},[]),W=(0,r.useCallback)(e=>{k(e),C(!0)},[]),E=(0,r.useCallback)(()=>{C(!1),k(null)},[]),O=(0,r.useCallback)(async e=>{i(!0),S(null);try{let t;P?(t=await g.A.updateOrder(P.id,e),y(e=>e.map(e=>e.id===P.id?t:e))):(t=await g.A.createOrder(e),y(e=>[...e,t])),C(!1),k(null)}catch(t){let e=t instanceof Error?t.message:"An unknown error occurred";console.error("Error saving order:",e),S("Failed to save order: ".concat(e))}finally{i(!1)}},[P]),$=(0,r.useCallback)(async e=>{if(window.confirm("Are you sure you want to delete this order?")){i(!0),S(null);try{await g.A.deleteOrder(e),y(t=>t.filter(t=>t.id!==e))}catch(t){let e=t instanceof Error?t.message:"An unknown error occurred";console.error("Error deleting order:",e),S("Failed to delete order: ".concat(e))}finally{i(!1)}}},[]),_=(0,r.useCallback)(()=>{e.push("/dashboard/orders/baking-list")},[e]);if(t)return(0,l.jsx)(x.default,{children:(0,l.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"60vh"},children:(0,l.jsx)(a.A,{})})});let L=[{id:"id",label:"Order ID",minWidth:80},{id:"customerName",label:"Customer",minWidth:150},{id:"date",label:"Pickup Date",minWidth:120},{id:"status",label:"Status",minWidth:120,format:e=>(0,l.jsx)(s.A,{label:e,color:"Pending"===e?"warning":"Confirmed"===e?"primary":"Completed"===e?"success":"Cancelled"===e?"error":"default",size:"small"})},{id:"totalItems",label:"Items",minWidth:80,align:"right"},{id:"totalPrice",label:"Total",minWidth:100,align:"right"},{id:"actions",label:"Actions",minWidth:150,align:"center",format:(e,t)=>t?(0,l.jsxs)(d.A,{children:[(0,l.jsx)(A.A,{size:"small",onClick:()=>{let e=p.find(e=>e.id===t.id);e&&W(e)},style:{marginRight:"8px"},children:"Edit"}),(0,l.jsx)(A.A,{size:"small",color:"error",onClick:()=>$(t.id),children:"Delete"})]}):null}];return(0,l.jsx)(u.A,{children:(0,l.jsxs)(n.A,{maxWidth:"xl",children:[w&&(0,l.jsx)(o.A,{severity:"error",sx:{mb:2},onClose:()=>S(null),children:w}),(0,l.jsxs)(d.A,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsx)(A.A,{onClick:D,children:"â† Back to Dashboard"}),(0,l.jsxs)(d.A,{children:[(0,l.jsx)(A.A,{onClick:_,style:{marginRight:"10px"},children:"Generate Baking List"}),(0,l.jsx)(c.A,{color:"primary",size:"medium",onClick:I,"aria-label":"add order",children:(0,l.jsx)(h.A,{})})]})]}),f?(0,l.jsx)(F,{products:v,order:P?q(P):z(),onSave:O,onCancel:E}):(0,l.jsx)(j.A,{title:"Orders",subtitle:"Manage customer orders",columns:L,data:p.map(e=>{let t=(null==e?void 0:e.items)?e.items.reduce((e,t)=>e+(t.quantity||0),0):0,i=(null==e?void 0:e.totalPrice)?"$".concat(e.totalPrice.toFixed(2)):"$0.00";return{id:null==e?void 0:e.id,customerName:(null==e?void 0:e.customerName)||"Unknown",date:(null==e?void 0:e.pickupDate)?new Date(e.pickupDate).toLocaleDateString():"No date",status:(null==e?void 0:e.status)||"Unknown",totalItems:t,totalPrice:i}}),searchEnabled:!0,emptyMessage:"No orders available"})]})})}},96663:(e,t,i)=>{Promise.resolve().then(i.bind(i,52932))}},e=>{var t=t=>e(e.s=t);e.O(0,[1091,4732,4829,6049,752,746,2502,1580,6874,5183,7494,6415,3831,2245,2729,6748,7277,386,3998,3431,8946,8441,1684,7358],()=>t(96663)),_N_E=e.O()}]);